default: &default
  adapter: postgresql
  encoding: unicode

  # Pool should generally align with RAILS_MAX_THREADS (per worker).
  pool: <%= ENV.fetch("RAILS_MAX_THREADS", 5) %>

  # These are fallbacks. If DATABASE_URL is set, Rails will prefer it.
  username: <%= ENV.fetch("PGUSER", "drruby") %>
  password: <%= ENV["PGPASSWORD"] %>
  host:     <%= ENV.fetch("PGHOST", "localhost") %>
  port:     <%= ENV.fetch("PGPORT", 5432) %>

  # If DATABASE_URL is set, Rails will prefer it over the other fields.
  url:      <%= ENV["DATABASE_URL"] %>

development:
  <<: *default
  database: amigos_unite_api_development

test:
  <<: *default
  database: amigos_unite_api_test

production:
  <<: *default

  # Name is used if DATABASE_URL is not set.
  database: amigos_unite_api_production

  # Optional production-specific overrides (still ignored if DATABASE_URL is set)
  username: <%= ENV.fetch("AMIGOS_UNITE_API_DB_USER", ENV.fetch("PGUSER", "drruby")) %>
  password: <%= ENV["AMIGOS_UNITE_API_DATABASE_PASSWORD"] || ENV["PGPASSWORD"] %>
  host:     <%= ENV.fetch("AMIGOS_UNITE_API_DB_HOST", ENV.fetch("PGHOST", "localhost")) %>
  port:     <%= ENV.fetch("AMIGOS_UNITE_API_DB_PORT", ENV.fetch("PGPORT", 5432)) %>
